{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tatsuyafujii/project/chatbot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tatsuyafujii/project/chatbot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/tatsuyafujii/project/chatbot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/tatsuyafujii/project/chatbot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useState,useEffect}from'react';import'./assets/styles/style.css';import{AnswersList,Chats}from\"./components\";import{FormDialog}from\"./components/Forms/index\";import{db}from'./firebase/index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),answers=_useState2[0],setAnswers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),chats=_useState4[0],setChats=_useState4[1];var _useState5=useState(\"init\"),_useState6=_slicedToArray(_useState5,2),currentId=_useState6[0],setCurrentId=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),dataset=_useState8[0],setDataset=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),open=_useState10[0],setOpen=_useState10[1];var displayNextQuestion=function displayNextQuestion(nextQuestionId,nextDataset){addChats({text:nextDataset.question,type:'question'});setAnswers(nextDataset.answers);setCurrentId(nextQuestionId);};var selectAnswer=function selectAnswer(selectedAnswer,nextQuestionId){switch(true){case /^https:*/.test(nextQuestionId):var a=document.createElement('a');a.href=nextQuestionId;a.target='_blank';a.click();break;case nextQuestionId==='contact':handleClickOpen();break;default:addChats({text:selectedAnswer,type:'answer'});setTimeout(function(){return displayNextQuestion(nextQuestionId,dataset[nextQuestionId]);},500);break;}};var handleClickOpen=function handleClickOpen(){setOpen(true);};var handleClose=useCallback(function(){setOpen(false);},[setOpen]);var addChats=function addChats(chat){setChats(function(prevChats){return[].concat(_toConsumableArray(prevChats),[chat]);});};useEffect(function(){var scrollArea=document.getElementById('scroll-area');if(scrollArea){scrollArea.scrollTop=scrollArea.scrollHeight;}});useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var initDataset;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:initDataset={};_context.next=3;return db.collection(\"questions\").get().then(function(snapshots){snapshots.forEach(function(doc){var id=doc.id;var data=doc.data();initDataset[id]=data;});});case 3:setDataset(initDataset);displayNextQuestion(currentId,initDataset[currentId]);case 5:case\"end\":return _context.stop();}}},_callee);}))();},[]);return/*#__PURE__*/_jsx(\"section\",{className:\"c-section\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"c-box\",children:[/*#__PURE__*/_jsx(Chats,{chats:chats}),/*#__PURE__*/_jsx(AnswersList,{answers:answers,select:selectAnswer}),/*#__PURE__*/_jsx(FormDialog,{open:open,handleClose:handleClose})]})});};export default App;","map":{"version":3,"sources":["/Users/tatsuyafujii/project/chatbot/src/App.jsx"],"names":["React","useCallback","useState","useEffect","AnswersList","Chats","FormDialog","db","App","answers","setAnswers","chats","setChats","currentId","setCurrentId","dataset","setDataset","open","setOpen","displayNextQuestion","nextQuestionId","nextDataset","addChats","text","question","type","selectAnswer","selectedAnswer","test","a","document","createElement","href","target","click","handleClickOpen","setTimeout","handleClose","chat","prevChats","scrollArea","getElementById","scrollTop","scrollHeight","initDataset","collection","get","then","snapshots","forEach","doc","id","data"],"mappings":"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","sourcesContent":["import React, {useCallback, useState, useEffect} from 'react';\nimport './assets/styles/style.css';\nimport {AnswersList, Chats} from \"./components\";\nimport {FormDialog} from \"./components/Forms/index\";\nimport {db} from './firebase/index'\n\nconst App = () => {\n    const [answers, setAnswers] = useState([]);\n    const [chats, setChats] = useState([]);\n    const [currentId, setCurrentId] = useState(\"init\");\n    const [dataset, setDataset] = useState({});\n    const [open, setOpen] = useState(false);\n\n\n    const displayNextQuestion = (nextQuestionId, nextDataset) => {\n        addChats({\n            text:nextDataset.question,\n            type: 'question'\n        })\n\n        setAnswers(nextDataset.answers)\n        setCurrentId(nextQuestionId)\n\n    }\n\n    const selectAnswer = (selectedAnswer, nextQuestionId) => {\n        switch (true){\n\n            case (/^https:*/.test(nextQuestionId)):\n                const a = document.createElement('a');\n                a.href = nextQuestionId;\n                a.target = '_blank';\n                a.click();\n                break;\n\n            case (nextQuestionId === 'contact'):\n                handleClickOpen();\n                break;\n\n            default:\n                addChats({\n                    text: selectedAnswer,\n                    type: 'answer'\n                })\n\n                setTimeout(() => displayNextQuestion(nextQuestionId,dataset[nextQuestionId]), 500);\n                break;\n        }\n    }\n    const handleClickOpen = () => {\n        setOpen(true)\n    };\n\n    const handleClose =  useCallback(() =>  {\n        setOpen(false)\n    },[setOpen]);\n\n    const addChats = (chat) => {\n        setChats(prevChats => {\n            return [...prevChats, chat]\n        })\n    }\n\n    useEffect(() => {\n        const scrollArea = document.getElementById('scroll-area');\n        if (scrollArea){\n            scrollArea.scrollTop = scrollArea.scrollHeight;\n        }\n    })\n\n    useEffect( () => {\n        (async () => {\n            const initDataset = {};\n\n            await db.collection(\"questions\").get().then(snapshots => {\n                snapshots.forEach(doc => {\n                    const id = doc.id\n                    const data = doc.data()\n                    initDataset[id] = data\n                })\n            })\n\n            setDataset(initDataset)\n            displayNextQuestion(currentId, initDataset[currentId])\n        })()\n    },[]);\n\n\n    return (\n            <section className={\"c-section\"}>\n                <div className={\"c-box\"}>\n                    <Chats chats={chats}/>\n                    <AnswersList answers={answers} select={selectAnswer}/>\n                    <FormDialog open={open} handleClose={handleClose}/>\n                </div>\n            </section>\n        );\n\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}